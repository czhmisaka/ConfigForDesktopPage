import{A as w,ar as T,L as D,a3 as N,k as R,r as m,n as E,o as M,aH as H,I as d,J as S,K as z,N as r,O as e,v as o,a9 as q,U as n,W as A,P as $,V as j,ai as G,bV as J,bT as K,a2 as O}from"./index-51f9d840.js";import{b as P,a as W,u as Q,E as X}from"./useDataThemeChange-4f5da68f.js";import{u as g}from"./hooks-d68a43b8.js";import{d as Y,a as Z}from"./dark-3fe330df.js";import"./iconPicker-a7b62dd4.js";const c=w({name:"Motion",props:{delay:{type:Number,default:50}},render(){const{delay:x}=this,_=T("motion");return D(N("div",{},{default:()=>[this.$slots.default()]}),[[_,{initial:{opacity:0,y:100},enter:{opacity:1,y:0,transition:{delay:x}}}]])}}),ee={class:"select-none"},ae={class:"flex-c absolute right-5 top-3"},oe={class:"login-container"},te={class:"login-box"},ne={class:"login-form"},se={class:"outline-none"},le=["innerHTML"],ie=w({name:"Login"}),re=w({...ie,setup(x){const _=R(),p=m(!1),f=m(),{initStorage:B}=P();B();const{dataTheme:h,dataThemeChange:b}=W();b();const{title:F}=Q(),t=E({username:"admin",password:"123456",captcha:""}),V=m(""),C=m(""),k=async l=>{if(p.value=!0,!!l)try{await l.validate((a,y)=>{if(a){const u={username:t.username,password:t.password,captchaId:C.value,verifyCode:t.captcha};G().loginByUsername(u).then(s=>{s&&s.token&&J().then(()=>{X.success("\u767B\u5F55\u6210\u529F"),_.push("/welcome")})}).catch(s=>{(s.code==12e3||s.code==11001)&&(t.captcha="",v())})}else return p.value=!1,y})}catch{}finally{p.value=!1}},v=async()=>{let l=await K("/admin/base/open/captcha",{width:96,height:32,color:"#ccc"});V.value=l.data.data,C.value=l.data.captchaId};function I({code:l}){l==="Enter"&&k(f.value)}return M(()=>{v(),window.document.addEventListener("keypress",I)}),H(()=>{window.document.removeEventListener("keypress",I)}),(l,a)=>{const y=d("el-switch"),u=d("el-input"),s=d("el-form-item"),L=d("el-button"),U=d("el-form");return S(),z("div",ee,[r("div",ae,[e(y,{modelValue:o(h),"onUpdate:modelValue":a[0]||(a[0]=i=>q(h)?h.value=i:null),"inline-prompt":"","active-icon":o(Y),"inactive-icon":o(Z),onChange:o(b)},null,8,["modelValue","active-icon","inactive-icon","onChange"])]),r("div",oe,[r("div",te,[r("div",ne,[e(o(c),null,{default:n(()=>[r("h2",se,A(o(F)),1)]),_:1}),e(U,{ref_key:"ruleFormRef",ref:f,model:t,size:"large"},{default:n(()=>[e(o(c),{delay:100},{default:n(()=>[e(s,{class:"formItem",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D26\u53F7",trigger:"blur"}],prop:"username"},{default:n(()=>[e(u,{clearable:"",modelValue:t.username,"onUpdate:modelValue":a[1]||(a[1]=i=>t.username=i),placeholder:"\u8D26\u53F7","prefix-icon":o(g)("user")},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1}),e(o(c),{delay:150},{default:n(()=>[e(s,{class:"formItem",prop:"password"},{default:n(()=>[e(u,{clearable:"","show-password":"",modelValue:t.password,"onUpdate:modelValue":a[2]||(a[2]=i=>t.password=i),placeholder:"\u5BC6\u7801","prefix-icon":o(g)("lock")},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1}),e(o(c),{delay:200},{default:n(()=>[e(s,{class:"formItem",prop:"captcha"},{default:n(()=>[e(u,{style:{width:"260px"},clearable:"",modelValue:t.captcha,"onUpdate:modelValue":a[3]||(a[3]=i=>t.captcha=i),placeholder:"\u9A8C\u8BC1\u7801","prefix-icon":o(g)("lock")},null,8,["modelValue","prefix-icon"]),r("div",{innerHTML:V.value,style:$({width:"96px",height:"40px",float:"right",marginLeft:"4px","border-radius":"4px",background:"rgba(0, 0, 0, 0.7)"}),onClick:v},null,12,le)]),_:1})]),_:1}),e(o(c),{delay:250},{default:n(()=>[e(L,{class:"w-full mt-4",size:"default",type:"primary",loading:p.value,onClick:a[4]||(a[4]=i=>k(f.value))},{default:n(()=>[j(" \u767B\u5F55 ")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])])])])}}});const _e=O(re,[["__scopeId","data-v-ea897677"]]);export{_e as default};
