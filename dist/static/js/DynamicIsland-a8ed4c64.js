import{A as z,bD as I,ap as b,a3 as p,b2 as w,b4 as k,aW as v,b_ as B,bp as O,bo as C,bn as L,bS as r,a2 as T,I as d,J as h,Z as f,U as W,N as a,S as P,K as u,P as c,O as y,X as g,W as $}from"./index-51f9d840.js";import{i as s}from"./DynamicIsland-51b6a251.js";const D=z({mixins:[I],name:"lessIcon",props:{name:{type:String},iconOption:{type:Object,default:()=>({})},isLoadingIcon:{type:Boolean,default:!1}},setup:e=>{const{isLoadingIcon:t,iconOption:i}=b(e);return()=>p(k,{style:{...i.value},color:i.value.color?i.value.color:"",size:i.value.fontSize?i.value.fontSize:"",class:[t.value?"is-loading":""]},()=>p(w(e.name+"")))}}),l={noMessage:"normal"},K=z({name:"\u7075\u52A8\u5C9B\u5C9B",nameEn:"DynamicIsland",mixins:[I],components:{cardBg:v,lessIcon:D,card:B},props:{info:{type:Object,default:()=>[]},size:{type:Object,default:()=>({x:4,y:.25,width:0,height:1,maxWidth:8,maxHeight:4})}},watch:{info:{handler(e){e.length>0&&this.pushInfo(e)}},"context.message":{handler(e){}},"context.info":{handler(e){e.length==0&&this.init(),!this.__isInInfo(s.image)&&this.__isInInfo(s.icon)&&this.startIcon(),this.__isInInfo(s.image)&&(e.map(t=>{t.type==s.image&&(this.context.image=t.image)}),this.startImage()),this.__isInInfo(s.message)&&(e.map(t=>{t.type==s.message&&(this.context.message=t.message)}),this.startMessage())}}},data(){return{infoType:s,status:{activeType:"",cardBgStyleOrigin:{background:"black",color:"white",overflow:"hidden"},cardBgStyle:{},class:""},context:{info:[],icon:[],message:"",element:{},image:"",timeLimit:"",needKillerInfo:{type:s.sleep}},gridInfo:{iconSize:{},position:{x:0,y:0},size:{width:0,height:0}}}},methods:{startMessage(){const e={x:this.size.y,y:this.size.y},t={width:this.size.maxWidth-this.size.y*2,height:this.size.height};this.__changeSize(t),this.__changePosition(e),this.status.class=l.noMessage},startImage(){const e={x:this.size.y,y:this.size.y},t={width:this.size.maxWidth-this.size.y*2,height:this.size.maxHeight};this.__changeSize(t),this.__changePosition(e),this.status.class=l.noMessage},startEl(){},startIcon(){const e={x:this.size.maxWidth/4,y:this.size.y},t={width:this.size.maxWidth/2,height:this.size.height};this.__changeSize(t),this.__changePosition(e),this.status.class=l.noMessage},cardOnChange(e,t){this.$emit()},async pushInfo(e){e.map(t=>{switch(t.type){case s.icon:this.context.icon.length>1&&this.context.icon.shift(),this.context.icon.push({name:t.icon,iconOption:t.options}),this.context.info=this.context.info.concat(e);break;case s.image:this.__timeLimit(t);break;case s.message:this.__timeLimit(t);break}}),await this.$nextTick(),this.__clearInfo()},touchStart(){if(this.info.length==0){const{size:e,position:t}=this.detail.gridInfo.default,i={...e,width:e.width+this.size.maxWidth/16},n={...t,x:t.x-this.size.maxWidth/32};this.__changeSize(i),this.__changePosition(n)}},touchend(){const{size:e,position:t}=this.detail.gridInfo.default,i={...e,width:e.width-this.size.maxWidth/16},n={...t,x:t.x+this.size.maxWidth/32};this.__changeSize(i),this.__changePosition(n)},init(){const e={x:this.size.maxWidth/3,y:this.size.y},t={width:this.size.maxWidth/3,height:this.size.height};this.__changeSize(t),this.__changePosition(e),this.status.class=l.noMessage},__changeSize(e){let t={};t[this.detail.label]=e,O(this,t)},__changePosition(e){let t={};t[this.detail.label]=e,C(this,t)},__clearInfo(){let e={};e[this.detail.key]={info:[]},L(this,e)},__clearInfoLocal(e){let t=r(this.context.info),i={type:s.sleep};clearTimeout(this.context.timeLimit),this.context.info=t.filter(n=>n.type!=e.type),this.context.needKillerInfo=i},__setInfoLocal(e){this.context.info=this.context.info.concat([e])},__isInInfo(e){return this.context.info.filter(t=>t.type==e).length>0},async __timeLimit(e){let{needKillerInfo:t}=this.context,i=!1;t&&t.type!=s.sleep&&(this.__clearInfoLocal(t),i=!0),setTimeout(()=>this.__setInfoLocal(e),i?420:0),this.context.needKillerInfo=e,e.time!=-1&&e.time>0&&(this.context.timeLimit=setTimeout(()=>{this.__clearInfoLocal(e)},e.time*1e3+(i?500:0)),this.context.needKillerInfo=r(e))}},computed:{height(){return this.size.height*this.sizeUnit.blockSize}},async mounted(){this.$emit("ready"),this.status.cardBgStyle=r(this.status.cardBgStyleOrigin),this.init()}});const M={class:"iconShadow"},U={key:0,class:"iconShadow"};function E(e,t,i,n,H,N){const m=d("lessIcon"),_=d("card"),x=d("cardBg");return h(),f(x,{"cus-style":e.status.cardBgStyle},{default:W(()=>[a("div",{class:P(e.status.class),onTouchstart:t[1]||(t[1]=(...o)=>e.touchStart&&e.touchStart(...o)),onTouchend:t[2]||(t[2]=(...o)=>e.touchend&&e.touchend(...o))},[e.context.icon.length>0?(h(),u("div",{key:0,class:"iconFlex",style:c({height:e.height+"px",color:"red"})},[a("div",M,[y(m,{name:e.context.icon[0].name,iconOption:{...e.context.icon[0].iconOption,margin:e.height*.2+"px",fontSize:e.height*.6+"px"}},null,8,["name","iconOption"])]),e.context.icon.length>1?(h(),u("div",U,[y(m,{name:e.context.icon[1].name,iconOption:{...e.context.icon[1].iconOption,margin:e.height*.2+"px",fontSize:e.height*.6+"px"}},null,8,["name","iconOption"])])):g("",!0)],4)):g("",!0),a("div",{class:"showBox",style:c({opacity:e.__isInInfo(e.infoType.image)?1:0,maxHeight:e.__isInInfo(e.infoType.image)?"100%":0,backgroundImage:`url(${e.context.image})`,backgroundSize:"cover",backgroundPosition:"center",marginTop:e.context.icon.length>0?"-"+e.height+"px":"",boxShadow:"inset 0px 0px 30px black ,"+(e.context.icon.length>0?"rgba(0, 0, 0, 1) 0px 18px 36px -18px inset;":"")})},null,4),a("div",{class:"showBox",style:c({opacity:e.__isInInfo(e.infoType.message)?1:0,marginTop:e.context.icon.length>0?"-"+e.height+"px":"",color:"white",fontSize:"16px",fontWeight:900,lineHeight:e.size.height*e.sizeUnit.blockSize+"px"})},$(e.context.message),5),a("div",{class:"showBox",style:c({opacity:e.__isInInfo(e.infoType.el)?1:0,marginTop:e.context.icon.length>0?"-"+e.height+"px":"",color:"white"})},[e.__isInInfo(e.infoType.el)?(h(),f(_,{key:0,ref:"card_DynamicIsland_0",detail:{...e.context.el,index:e.index},baseData:e.baseData,sizeUnit:e.sizeUnit,gridList:e.gridList,onOnChange:t[0]||(t[0]=(o,S)=>e.cardOnChange(o,S))},null,8,["detail","baseData","sizeUnit","gridList"])):g("",!0)],4)],34)]),_:1},8,["cus-style"])}const V=T(K,[["render",E],["__scopeId","data-v-0167e974"]]);export{V as default};
