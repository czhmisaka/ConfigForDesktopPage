import{A as q,bc as A,aW as O,bO as V,a_ as P,bP as R,bd as N,bQ as E,a2 as U,I as i,J as n,K as u,O as a,U as s,N as h,V as l,Q as k,R as g,W as f,Z as c,X as d,P as G,a6 as j,aj as H,ak as W}from"./index-51f9d840.js";import{u as M}from"./hooks-d68a43b8.js";import"./iconPicker-a7b62dd4.js";const z=E();let C=null;const Q=q({name:"\u8868\u5355\u7EC4\u4EF6",props:["query","queryItemTemplate","queryItemConfig","btnList","autoSearch","selectedList"],watch:{query:{handler(e){this.refreshData(e)},deep:!0,immediate:!0},queryItemTemplate:{handler(e){this.initForm(e)},immediate:!0}},computed:{isNeedClose(){return!1}},components:{VueForm:A,cardBg:O,iconCell:V},data(){return{formData:{},uiSchema:{},formFooter:{show:!1},isOpen:!0,formProps:{layoutColumn:3,inlineFooter:!1,labelSuffix:"\uFF1A",labelPosition:"top",isMiniDes:!1,defaultSelectFirstOption:!0,labelWidth:"120px"},schema:{type:"object",properties:{}},btnActionTemplate:P,actionUrl:z,screenFormList:[],checkboxScreenGroup:[]}},methods:{useRenderIcon:M,async changeStatus(){const e=this.queryItemTemplate.map(o=>{if(this.checkboxScreenGroup.includes(o.key))return{...o}});await this.initForm(e)},async resetStatus(){this.initScreenForm(),await this.initForm(this.queryItemTemplate)},initScreenForm(e=this.queryItemTemplate){const o=[];this.screenFormList=e.map(m=>(o.push(m.key),{label:m.label,key:m.key})),this.checkboxScreenGroup=o},getDownLoadRequestHeaders(){return R()},async initForm(e=this.queryItemTemplate){Object.keys(this.query).length>0;let o={};o=await N(e,this,!1),this.schema.properties=o},onChange(e){this.$emit("inputChange",this.formData),this.formData.pageNumber||this.handleSubmit(this.formData,"ooo")},handleSubmit(e){e.pageNumber=1,this.$emit("search",e)},btnClick(e,o){this.$emit("btnClick",e,o)},changeOpen(){this.isOpen=!this.isOpen,this.isOpen?this.initForm():this.initForm(this.queryItemTemplate.slice(0,this.formProps.layoutColumn))},refreshData(e){if(e===-1)this.formData={},this.$emit("inputChange",{}),this.$nextTick().then(()=>{this.handleSubmit()});else if(e&&Object.keys(e).length>0)for(let o in e)this.formData[o]!=e[o]&&(this.formData[o]=e[o]);else this.formData=e},addFileCreate(e){this.$emit("inputChange",e)},errorFile(e){this.$emit("inputChange",e)},exceedFile(e){this.$emit("inputChange",e)}},async mounted(){this.refreshData(this.query);let e=this;C&&clearInterval(C),C=setInterval(()=>{if(e.$refs.formBox&&e.$refs.formBox.$el){let o=e.$refs.formBox.$el.offsetWidth;o>600?e.formProps.layoutColumn=3:o>400?e.formProps.layoutColumn=2:e.formProps.layoutColumn=1}},100),await this.initForm(this.queryItemTemplate),setTimeout(()=>{this.initScreenForm()},200)}});const X=e=>(H("data-v-20473ede"),e=e(),W(),e),J={key:0},K={class:"screenDiv"},Y={class:"filterDiv"},Z=X(()=>h("div",{class:"filterTitle"},"\u7B5B\u9009\u9009\u9879",-1)),x={class:"filterContent"},ee={class:"filterBtnList"},te={key:0,"slot-scope":"{ formData }",style:{textAlign:"right"}},oe={class:"hoverButton"},se=["onClick"],ne={key:0,class:"TopRight"};function ae(e,o,m,re,ie,le){const S=i("ArrowRight"),D=i("el-icon"),v=i("el-checkbox"),F=i("el-checkbox-group"),p=i("el-button"),_=i("el-popover"),T=i("el-upload"),L=i("VueForm"),B=i("iconCell"),w=i("cardBg");return e.queryItemTemplate&&e.queryItemTemplate.length>0||e.btnList&&e.btnList.length>0||!e.autoSearch?(n(),u("div",J,[a(w,{ref:"formBox",class:"formBox","cus-style":{padding:"0px",height:"auto",paddingBottom:e.btnList&&e.btnList.length>0||!e.autoSearch?"12px":"0px","border-radius":"6px",border:"0px solid",filter:"none","box-shadow":"none",display:"inline-block"}},{default:s(()=>[a(_,{trigger:"hover",width:332,placement:"right-start"},{reference:s(()=>[h("div",K,[l("\u7B5B\u9009 "),a(D,null,{default:s(()=>[a(S)]),_:1})])]),default:s(()=>[h("div",Y,[Z,h("div",x,[a(F,{modelValue:e.checkboxScreenGroup,"onUpdate:modelValue":o[0]||(o[0]=t=>e.checkboxScreenGroup=t)},{default:s(()=>[(n(!0),u(k,null,g(e.screenFormList,t=>(n(),u("div",{key:t.key},[a(v,{label:t.key},{default:s(()=>[l(f(t.label),1)]),_:2},1032,["label"])]))),128))]),_:1},8,["modelValue"])]),h("div",ee,[a(p,{type:"primary",onClick:e.changeStatus},{default:s(()=>[l("\u786E\u5B9A")]),_:1},8,["onClick"]),a(p,{style:{color:"#0A1F44"},onClick:e.resetStatus},{default:s(()=>[l("\u91CD\u7F6E")]),_:1},8,["onClick"])])])]),_:1}),a(L,{modelValue:e.formData,"onUpdate:modelValue":o[3]||(o[3]=t=>e.formData=t),style:{textAlign:"left"},schema:e.schema,"ui-schema":e.uiSchema,formProps:e.formProps,onChange:e.onChange},{default:s(()=>[e.btnList&&e.btnList.length>0||!e.autoSearch?(n(),u("div",te,[!e.autoSearch&&e.queryItemTemplate&&e.queryItemTemplate.length>0?(n(),c(p,{key:0,class:"btn",onClick:o[1]||(o[1]=t=>e.refreshData(-1)),icon:"RefreshRight",plain:""},{default:s(()=>[l("\u91CD\u7F6E")]),_:1})):d("",!0),e.autoSearch?d("",!0):(n(),c(p,{key:1,class:"btn",plain:"",type:"primary",onClick:o[2]||(o[2]=t=>e.handleSubmit(e.formData)),style:{"margin-left":"0px"},icon:"Position"},{default:s(()=>[l("\u641C\u7D22")]),_:1})),(n(!0),u(k,null,g((e.btnList||[]).filter(t=>t&&t.isShow?t.isShow({...e.formData,_selectedList:e.selectedList},t):!0),(t,$)=>{var I;return n(),u("div",{key:$+"btn",class:"floatLeft",style:G(t.style?t.style:"")},[t.type==e.btnActionTemplate.UploadFunction?(n(),c(T,{key:0,ref_for:!0,ref:"uploadRef",headers:e.getDownLoadRequestHeaders(),class:"upload-demo",action:e.actionUrl+(t.uploadInfo?t.uploadInfo.action:""),limit:t.uploadInfo?t.uploadInfo.limit:1,data:t.uploadInfo?(I=t.uploadInfo)==null?void 0:I.data:{},"on-success":(r,y,b)=>e.btnClick(t,r),"on-error":(r,y,b)=>e.btnClick(t,r),"on-exceed":(r,y,b)=>e.btnClick(t,r),"show-file-list":!1},{default:s(()=>[a(p,{plain:"",icon:"plus",type:"primary"},{default:s(()=>[l(f(t.label),1)]),_:2},1024)]),_:2},1032,["headers","action","limit","data","on-success","on-error","on-exceed"])):d("",!0),t.type==e.btnActionTemplate.HoverFunction?(n(),c(_,{key:1},{reference:s(()=>[a(p,{type:t.elType?typeof t.elType!="string"?t.elType(e.formData):t.elType:"",ico:t.hoverIcon},{default:s(()=>[l(f(t.hoverInfo.hoverText),1)]),_:2},1032,["type","ico"])]),default:s(()=>[h("div",oe,[(n(!0),u(k,null,g(t.hoverInfo.hoverList,(r,y)=>(n(),u("div",{class:"hoverButtonItem",key:y,onClick:b=>e.btnClick(t,r)},[(n(),c(j(e.useRenderIcon({...r})),{class:"iconCell"})),l(" "+f(r.label),1)],8,se))),128))])]),_:2},1024)):(n(),c(p,{key:2,loading:t.isLoading,onClick:r=>e.btnClick(t),disabled:t.isDisable({...e.formData,_selectedList:e.selectedList},t),type:t.elType?typeof t.elType!="string"?t.elType(e.formData):t.elType:"",plain:"",icon:t.hoverIcon},{default:s(()=>[l(f(t.label),1)]),_:2},1032,["loading","onClick","disabled","type","icon"]))],4)}),128))])):d("",!0)]),_:1},8,["modelValue","schema","ui-schema","formProps","onChange"]),e.isNeedClose?(n(),u("div",ne,[a(B,{name:e.isOpen?"ArrowDownBold":"ArrowUpBold",onClick:e.changeOpen,iconOption:{fontSize:"12px"}},null,8,["name","onClick"])])):d("",!0)]),_:1},8,["cus-style"])])):d("",!0)}const de=U(Q,[["render",ae],["__scopeId","data-v-20473ede"]]);export{de as default};
