import{A,a$ as $,b0 as l,aW as E,bc as V,b1 as N,bd as O,be as j,bf as M,a_ as b,a2 as R,I as r,J as a,Z as d,U as u,K as s,W as f,X as p,S as T,O as g,T as U,Q as _,R as k,N as h,a6 as W,V as z,aj as J,ak as K}from"./index-51f9d840.js";let w={};const q=A({componentInfo:{labelNameCN:"\u8868\u5355\u9875\u9762",key:"formPage",description:"",gridInfo:{middle:$(12,8)}},propsDetail:{title:{label:"\u8868\u5355\u5C55\u793A\u6A21\u7248",description:"\u4E00\u6B21\u6027\u83B7\u53D6\u6240\u6709\u6570\u636E",type:l.text},formDataFunc:{label:"\u8868\u5355\u6570\u636E\u83B7\u53D6",type:l.functionEditor},defaultFormData:{label:"\u8868\u5355\u9ED8\u8BA4\u6570\u636E",description:"",type:l.obj},showItemTemplate:{label:"\u8868\u5355\u5C55\u793A\u6A21\u7248",description:"\u4E00\u6B21\u6027\u83B7\u53D6\u6240\u6709\u6570\u636E",type:l.functionEditor},formInputTemplate:{label:"\u8868\u5355\u8F93\u5165\u6A21\u7248",type:l.obj},btnList:{label:"\u64CD\u4F5C\u6309\u94AE\u5217\u8868",type:l.obj},showTypeProp:{label:"\u5C55\u793A\u65B9\u5F0F",type:l.boolean}},baseProps:{},props:["formDataFunc","title","defaultFormData","showItemTemplate","formInputTemplate","btnList","showTypeProp","cusStyle"],components:{cardBg:E,VueForm:V},watch:{defaultFormData:{async handler(e){this.isReady&&(this.$emit("ready",!1),await this.init(),await this.initForm(),this.$emit("ready"))},immediate:!0,deep:!0},formData:{handler(e){this.isReady&&this.checkOnChange(e)},immediate:!0,deep:!0}},data:()=>({searchResult:[],formItemTemplate:[],showType:N,schema:{type:"object",properties:{}},formData:{},uiSchema:{},formProps:{layoutColumn:1,inlineFooter:!1,labelSuffix:"",labelPosition:"left",isMiniDes:!1,defaultSelectFirstOption:!0,labelWidth:"120px"},isReady:!1}),async mounted(){await this.init(),await this.initForm(),this.$emit("ready"),this.isReady=!0},methods:{async initForm(e=this.formInputTemplate){let o={};o=await O(e,this,!0),this.schema={...this.schema,properties:o},this.uiSchema=j(e,this)},async init(){this.defaultFormData&&(this.formData=this.defaultFormData,w=M(this.formData)),this.formDataFunc&&(this.formData=await this.formDataFunc(this))},async btnClick(e){if(e.isLoading=!0,e.type==b.OpenDrawer)this.$modules.getModuleApi().userManage_openDrawerForm(this,e.drawerProps);else if(e.type==b.Function&&e.function){let o=this;try{await e.function(o,o.formData)}catch{}this.$emit("search")}else e.type==b.Url&&window.open(e.url);e.isLoading=!1},async checkOnChange(e=this.formData,o=!1){Object.keys(e).map(n=>{(e[n]!=w[n]||o)&&(this.formInputTemplate.map(async m=>{if(m.key==n&&m.input&&m.input.onChangeFunc){const D=this,i=await m.input.onChangeFunc(D,this.formData,n);if(i&&i.length&&i[0].key)this.initForm(i);else if(i){for(let y in i)this.formData[y]=i[y];this.$forceUpdate()}}}),w[n]=e[n])})}}});const B=e=>(J("data-v-c73ef0e5"),e=e(),K(),e),Q={key:0,class:"formPageTitle"},X=B(()=>h("div",{"slot-scope":"{ formData }",style:{textAlign:"right"}},null,-1)),Z={style:{width:"100%",fontWeight:"bold",display:"flex",justifyContent:"space-between",marginLeft:"1em"}},G=B(()=>h("div",null,":",-1)),H={key:0},Y={key:1,style:{cursor:"auto","user-select":"all"}},x={key:2,style:{cursor:"auto","user-select":"all"}},ee={key:3,style:{textAlign:"left"}},te={class:"btnListStyle"};function ae(e,o,n,m,D,i){const y=r("VueForm"),C=r("el-scrollbar"),S=r("el-form-item"),L=r("el-form"),v=r("el-divider"),P=r("el-button"),I=r("cardBg");return a(),d(I,{cusStyle:{padding:"12px",...e.cusStyle}},{default:u(()=>[e.title?(a(),s("div",Q,f(e.title),1)):p("",!0),(!e.showTypeProp||e.showTypeProp=="edit")&&e.formData&&e.formProps&&e.formInputTemplate?(a(),s("div",{key:1,class:T(["formBody",{formBody_noBtn:!e.btnList||e.btnList.length==0,formBody_noTitle:!e.title,formBody_noTitle_noBtn:(!e.btnList||e.btnList.length==0)&&!e.title}])},[g(C,null,{default:u(()=>[e.showTypeProp=="edit"?(a(),d(y,{key:0,modelValue:e.formData,"onUpdate:modelValue":o[0]||(o[0]=t=>e.formData=t),style:{textAlign:"left"},schema:e.schema,"ui-schema":e.uiSchema,formProps:e.formProps},{default:u(()=>[X]),_:1},8,["modelValue","schema","ui-schema","formProps"])):p("",!0)]),_:1})],2)):p("",!0),e.showTypeProp=="show"?(a(),s("div",{key:2,class:T({formBody_noBtn:!e.btnList||e.btnList.length==0,formBody_noTitle:!e.title,formBody_noTitle_noBtn:(!e.btnList||e.btnList.length==0)&&!e.title})},[e.showTypeProp=="show"?(a(),d(L,{key:0,ref:"form",onSubmit:o[1]||(o[1]=U(()=>{},["prevent"])),"label-position":"left",size:"large",style:{"text-align":"left"}},{default:u(()=>[(a(!0),s(_,null,k(e.showItemTemplate.filter(t=>t.table.type!=e.showType.btnList),(t,c)=>(a(),d(S,{"label-width":"160px",label:t.label,key:c+"btnFormList"},{label:u(F=>[h("div",Z,[h("div",null,f(F.label),1),G])]),default:u(()=>[t.table.type==e.showType.funcComponent?(a(),s("span",H,[(a(),d(W(t.table.showFunc(e.defaultFormData,t.key))))])):t.table.type==e.showType.func?(a(),s("span",Y,f(t.table.showFunc(e.defaultFormData,t.key)),1)):t.table.type==e.showType.dataKey?(a(),s("span",x,f(e.defaultFormData[t.key]),1)):p("",!0)]),_:2},1032,["label"]))),128))]),_:1},512)):p("",!0)],2)):p("",!0),e.btnList&&e.btnList.length>0?(a(),s("div",ee,[g(v),h("div",te,[(a(!0),s(_,null,k(e.btnList.filter(t=>t&&t.isShow?t.isShow(e.defaultFormData,JSON.parse(JSON.stringify(t))):!0),(t,c)=>(a(),s("div",{key:c+"btn",style:{"margin-right":"6px",display:"inline-block"}},[g(P,{loading:t.isLoading,onClick:F=>e.btnClick(t),type:t.elType,icon:t.icon},{default:u(()=>[z(f(t.label),1)]),_:2},1032,["loading","onClick","type","icon"])]))),128))])])):p("",!0)]),_:1},8,["cusStyle"])}const se=R(q,[["render",ae],["__scopeId","data-v-c73ef0e5"]]);export{se as default};
