import{B as r,Z as m,o as l,q as f,L as g,l as e,u as o,k as i,ap as h,bC as y,p as b,R as c,w as k,by as w,bD as x,bE as C}from"./index-b5229559.js";const B={class:"wrapper"},D={class:"content"},E=e("div",{class:"top-bar"},[e("div",{class:"top-bar-left"}),e("div",{class:"top-bar-title"}),e("div",{class:"top-bar-eight"})],-1),L={key:0,class:"form fade"},S={key:0,class:"spinner"},V=e("div",{class:"double-bounce1"},null,-1),M=[V],N={key:1},P={key:1,class:"form fade"},R={class:"avatar"},T=["src"],U={class:"user-panel"},q=e("div",null,null,-1),I={__name:"login",emits:["ready","onChange"],setup(z,{emit:v}){var s={idle:0,loading:1,success:2,error:3};const a=r(s.idle),t=r({name:"",avatar:""});function u(){a.value==s.idle&&(a.value=s.loading,setTimeout(async()=>{let n=await x("/userinfo",{body:{name:t.value.name}});n.data.length==0?await C("/userinfo",{name:t.value.name,avatar:"https://avatars.githubusercontent.com/u/22533472?v=4"}):t.value=n.data[0],a.value=s.success},1e3))}function _(){a.value==s.success&&(a.value=s.idle)}return m(()=>{v("ready"),window.onkeyup=()=>{let n=window.event.key;n=="ArrowDown"||n=="Enter"&&u()}}),(n,d)=>(l(),f(o(w),{id:"login-panel"},{default:g(()=>[e("div",B,[e("div",D,[E,a.value!=o(s).success?(l(),i("div",L,[h(e("input",{type:"text","onUpdate:modelValue":d[0]||(d[0]=p=>t.value.name=p),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",class:"input"},null,512),[[y,t.value.name]]),e("div",{onClick:u,style:b({maxWidth:a.value==o(s).loading?"40px":"80px",borderRadius:a.value==o(s).loading?"20px":"5px"}),class:"confirm-button"},[a.value==o(s).loading?(l(),i("div",S,M)):c("",!0),a.value==o(s).idle?(l(),i("div",N,"\u767B\u9646")):c("",!0)],4)])):c("",!0),a.value==o(s).success?(l(),i("div",P,[e("div",R,[e("img",{src:t.value.avatarUrl,alt:""},null,8,T)]),e("div",U,"\u597D\uFF01\u4E00\u770B\u5C31\u77E5\u9053\u300A"+k(t.value.name)+"\u300B\u5F88\u6709\u7CBE\u795E\uFF01",1),e("div",{onClick:_,class:"confirm-button red"},"\u6CE8\u9500")])):c("",!0),q])])]),_:1}))}};export{I as default};
