import{A as v,a$ as I,b0 as u,aW as b,bG as w,a_ as F,a2 as S,I as y,J as i,Z as m,U as c,N as o,S as $,O as f,P as z,bH as A,T as k,L as P,V as D,M as L,W as B,X as d,K as g}from"./index-51f9d840.js";const M=Math.floor(Math.random()*1e7),O=v({componentInfo:{labelNameCN:"\u83DC\u5355\u5217\u8868\u7EC4\u4EF6",key:"menuList",description:"\u66F4\u5177\u8F93\u5165\u7684menuData\u5C55\u793A\u5217\u8868\uFF0C\u70B9\u51FB\u8F93\u51FA\u5BF9\u5E94\u7684\u5355\u5143\u5BF9\u8C61",gridInfo:{middle:I(3,8)}},propsDetail:{treeDataFunc:{label:"\u6811\u72B6\u5217\u8868\u6570\u636E\uFF08\u4E00\u6B21\u6027\u83B7\u53D6\uFF09",description:"\u4E00\u6B21\u6027\u83B7\u53D6\u6240\u6709\u6570\u636E",type:u.functionEditor},outputKey:{label:"baseData\u8F93\u51FAkey",type:u.text},defaultProps:{label:"\u6570\u636E\u66FF\u6362\u65B9\u6848",description:"\u53C2\u8003\u6587\u6863\uFF1Ahttps://element-plus.org/zh-CN/component/tree.html#props",type:u.obj},clickItemDetailFunc:{label:"\u70B9\u51FB\u5143\u7D20\u8BE6\u60C5\u4E8B\u4EF6",description:"\u4E00\u822C\u7528\u4E8E\u5C55\u793A\u5143\u7D20\u5F39\u7A97\u7B49",type:u.functionEditor},clickItemFunc:{label:"\u70B9\u51FB\u5143\u7D20\u8BE6\u60C5\u4E8B\u4EF6",description:"\u4E00\u822C\u7528\u4E8E\u5C55\u793A\u5143\u7D20\u5F39\u7A97\u7B49",type:u.functionEditor},searchBtn:{label:"\u5B9A\u5236\u6309\u94AE1",type:u.obj}},baseProps:{clickItemDetailFunc:!1,treeDataFunc:(e,t)=>{let a=0,s=(n="")=>({label:"Hello World _ "+n,value:"\u6D4B\u8BD5\u6570\u636E"+a++});return t?"1234567".split("").map(n=>s(t)):[{...s(),children:[s(),s()]}]},outputKey:"menuSelectCell",defaultProps:{children:"children",label:"label"}},props:["baseData","sizeUnit","outputKey","defaultProps","treeDataFunc","treeDataFuncByLevel","clickItemDetailFunc","clickItemFunc","searchBtn","searchFuncPlaceHolder","searchFuncByName","detail"],components:{cardBg:b},watch:{selectedKey(e){this.searchResult=[]}},data:()=>({treeData:[],selectedKey:"",random:M,size:"small",searchResult:[],expandedKey:[]}),async mounted(){if(await this.init(),this.treeData&&this.treeData[0]&&this.treeData[0].children&&this.treeData[0].children[0]){const e=this.treeData[0].children[0],t=this;this.$nextTick(()=>{this.$refs.elTree.setCurrentKey(e.id),this.clickItemFunc&&this.clickItemFunc(t,e)})}},methods:{isBtnShow(e){const t=this;return e.isShow(t,e)},nodeChangeOpen(e){const t=this;t.expandedKey.push(e.id),localStorage.setItem(location.hash,JSON.stringify(t.expandedKey))},nodeChangeClose(e){const t=this;t.expandedKey=t.expandedKey.filter(a=>a!=e.id),localStorage.setItem(location.hash,JSON.stringify(t.expandedKey))},nodeClick(e){let t=this.outputKey||"menuList_output",a={};const s=this;a[t]=JSON.parse(JSON.stringify(e)),this.clickItemFunc&&this.clickItemFunc(s,e),w(this,a)},async init(){if(this.treeDataFunc){let t=this;t.expandedKey=Array.from(new Set(JSON.parse(localStorage.getItem(location.hash)))),t.treeData=await t.treeDataFunc(t)}const e=this;setTimeout(()=>{const t=document.querySelector(`.box_${e.random} .custom-tree-node`);t&&"click"in t&&t.click(),e.$emit("ready")},100)},async search(e){const t=this;let a=await this.treeDataFunc(t,this.selectedKey);this.searchResult=a.length>1?a.reduce((s,n)=>{let h=[];return n.children&&(h=n.children,delete n.children),s.length?s.concat(n).concat(h):[s].concat(n).concat(h)}):a},async clickItemDetail(e){const t=this;this.clickItemDetailFunc&&this.clickItemDetailFunc(t,e)},async btnClick(e,t){if(e.isLoading=!0,e.type==F.OpenDrawer)this.$modules.getModuleApi().userManage_openDrawerForm(this,e.drawerProps);else if(e.type==F.Function&&e.function){let a=this;await e.function(a,t),this.$emit("search")}else e.type==F.Url&&window.open(e.url);e.isLoading=!1}}});const T={class:"searchBar"},V={key:0,class:"content"},R={class:"custom-tree-node"},J={class:"text"},H={key:1,class:"content"},U={class:"custom-tree-node"},W={class:"text"};function j(e,t,a,s,n,h){const K=y("el-input"),p=y("el-button"),C=y("el-tree"),E=y("cardBg");return i(),m(E,{cusStyle:{padding:"12px"}},{default:c(()=>[o("div",{class:$(`menuBox box_${e.random}`)},[o("div",T,[f(K,{style:z({width:"100%",marginRight:e.searchBtn||e.selectedKey!=""?"6px":""}),modelValue:e.selectedKey,"onUpdate:modelValue":t[0]||(t[0]=l=>e.selectedKey=l),size:e.size,placeholder:e.searchFuncPlaceHolder||"\u641C\u7D22",onKeydown:t[1]||(t[1]=A(k(l=>e.searchFuncByName?e.searchFuncByName():e.search({}),["prevent"]),["enter"])),clearable:""},null,8,["style","modelValue","size","placeholder"]),P(f(p,{onClick:t[2]||(t[2]=l=>e.searchFuncByName?e.searchFuncByName():e.search({})),size:e.size,plain:"",type:"primary"},{default:c(()=>[D(" \u641C\u7D22 ")]),_:1},8,["size"]),[[L,e.selectedKey&&e.selectedKey.length>0]]),e.searchBtn&&e.isBtnShow(e.searchBtn)&&e.searchBtn&&e.selectedKey.length==0?(i(),m(p,{key:0,style:{"margin-left":"0px"},size:e.size,loading:e.searchBtn.isLoading,type:e.searchBtn.elType,plain:"",onClick:t[3]||(t[3]=l=>e.btnClick(e.searchBtn))},{default:c(()=>[D(B(e.searchBtn.label),1)]),_:1},8,["size","loading","type"])):d("",!0)]),e.searchResult.length!=0&&e.selectedKey?(i(),g("div",V,[f(C,{data:e.searchResult,props:e.defaultProps,onNodeClick:e.nodeClick,"highlight-current":!0,"node-key":"id","default-expanded-keys":e.expandedKey},{default:c(({node:l,data:r})=>[o("div",R,[o("div",J,B(r[e.defaultProps.label]),1),e.clickItemDetailFunc?(i(),m(p,{key:0,text:"",size:"small",icon:"More",class:"btns",onClick:k(N=>e.clickItemDetail(r),["stop"])},null,8,["onClick"])):d("",!0)])]),_:1},8,["data","props","onNodeClick","default-expanded-keys"])])):d("",!0),e.searchResult.length==0&&e.selectedKey==""?(i(),g("div",H,[f(C,{data:e.treeData,props:e.defaultProps,onNodeClick:e.nodeClick,"highlight-current":!0,"node-key":"id",ref:"elTree",onNodeExpand:e.nodeChangeOpen,onNodeCollapse:e.nodeChangeClose,"default-expanded-keys":e.expandedKey},{default:c(({node:l,data:r})=>[o("div",U,[o("div",W,B(r[e.defaultProps.label]),1),e.clickItemDetailFunc?(i(),m(p,{key:0,text:"",size:"small",icon:"More",class:"btns",onClick:k(N=>e.clickItemDetail(r),["stop"])},null,8,["onClick"])):d("",!0)])]),_:1},8,["data","props","onNodeClick","onNodeExpand","onNodeCollapse","default-expanded-keys"])])):d("",!0)],2)]),_:1})}const q=S(O,[["render",j],["__scopeId","data-v-c17ed462"]]);export{q as default};
